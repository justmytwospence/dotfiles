#!/usr/bin/env bash
sudo apt install -y stow
stow linux --dir $HOME/dotfiles --no-folding

sudo apt-add-repository -y ppa:teejee2008/ppa
sudo apt update
sudo apt install -y aptik

sudo aptik --basepath "$HOME/dotfiles/linux/.config/aptik" --restore-repos
sudo aptik --basepath "$HOME/dotfiles/linux/.config/aptik" --restore-packages
sudo aptik --basepath "$HOME/dotfiles/linux/.config/aptik" --restore-dconf

sudo snap install communitheme

mkdir $HOME/src
git clone https://git.savannah.gnu.org/git/emacs.git $HOME/src/emacs
(cd $HOME/dotfiles && git checkout emacs-26.1)
(cd $HOME/dotfiles && .autogen.sh && ./configure && sudo make && sudo make install)

systemctl --user enable emacs.service
systemctl --user enable jupyter.service
systemctl --user enable mailpile.service
systemctl --user enable pgweb.service

sudo update-alternatives --set x-www-browser $(which firefox)
xdg-settings set default-web-browser firefox.desktop
